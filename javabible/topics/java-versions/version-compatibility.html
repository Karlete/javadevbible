<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Version Compatibility - JavaDev Bible</title>
    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="../../css/syntax-highlighting.css">
</head>
<body class="topic-page">
    <header class="topic-header">
        <div class="header-content">
            <nav class="breadcrumb">
                <a href="../../index.html">Home</a> / <a href="../../index.html#java-versions">Java Versions</a> / Version Compatibility
            </nav>
            <h1>Version Compatibility</h1>
            <p class="topic-subtitle">Understanding Java Binary and API Compatibility</p>
            <a href="../../index.html" class="back-btn">&larr; Back to Index</a>
        </div>
    </header>

    <main class="topic-content">
        <section class="content-section">
            <h2>What is Version Compatibility?</h2>
            <p>Version compatibility in Java refers to the ability of code compiled with one version of Java to run on different versions of the JVM. Java maintains strong backward compatibility, but understanding the nuances is essential for multi-version environments.</p>

            <div class="info-box note">
                <div class="info-box-title">Key Compatibility Types</div>
                <ul>
                    <li><strong>Binary Compatibility</strong> - Can compiled bytecode run on a different JVM version?</li>
                    <li><strong>Source Compatibility</strong> - Can source code compile with a different JDK version?</li>
                    <li><strong>API Compatibility</strong> - Are the same classes and methods available?</li>
                </ul>
            </div>
        </section>

        <section class="content-section">
            <h2>Class File Version Numbers</h2>
            <p>Each Java version produces class files with a specific major version number. The JVM uses this to determine compatibility.</p>

            <pre><code><span class="comment">// Check class file version with javap</span>
<span class="comment">// javap -verbose MyClass.class | grep "major version"</span>

<span class="comment">// Major version numbers:</span>
<span class="comment">// Java 8  = 52</span>
<span class="comment">// Java 11 = 55</span>
<span class="comment">// Java 17 = 61</span>
<span class="comment">// Java 21 = 65</span></code></pre>

            <div class="info-box warning">
                <div class="info-box-title">Forward Compatibility Limitation</div>
                <p>A JVM can run class files from its version or <em>earlier</em>, but NOT later versions. Java 11 cannot run classes compiled with Java 17.</p>
            </div>

            <h3>Version Number Reference Table</h3>
            <pre><code><span class="comment">Java Version    Class File Version    Major Number</span>
Java 1.1        45.0                  45
Java 1.2        46.0                  46
Java 1.3        47.0                  47
Java 1.4        48.0                  48
Java 5          49.0                  49
Java 6          50.0                  50
Java 7          51.0                  51
Java 8          52.0                  52
Java 9          53.0                  53
Java 10         54.0                  54
Java 11         55.0                  55
Java 12         56.0                  56
Java 17         61.0                  61
Java 21         65.0                  65</code></pre>
        </section>

        <section class="content-section">
            <h2>Checking Compatibility</h2>

            <h3>Determine Class File Version</h3>
            <pre><code><span class="comment">// Using javap command</span>
$ javap -verbose MyClass.class | grep "major version"
  major version: 61

<span class="comment">// Programmatically in Java</span>
<span class="keyword">public class</span> <span class="class-name">ClassVersionChecker</span> {
    <span class="keyword">public static void</span> <span class="function">main</span>(<span class="class-name">String</span>[] args) <span class="keyword">throws</span> <span class="class-name">Exception</span> {
        <span class="keyword">try</span> (<span class="class-name">DataInputStream</span> dis = <span class="keyword">new</span> <span class="class-name">DataInputStream</span>(
                <span class="keyword">new</span> <span class="class-name">FileInputStream</span>(<span class="string">"MyClass.class"</span>))) {

            <span class="keyword">int</span> magic = dis.readInt();  <span class="comment">// 0xCAFEBABE</span>
            <span class="keyword">int</span> minor = dis.readUnsignedShort();
            <span class="keyword">int</span> major = dis.readUnsignedShort();

            <span class="class-name">System</span>.out.println(<span class="string">"Major version: "</span> + major);
        }
    }
}</code></pre>

            <h3>Check Runtime Version</h3>
            <pre><code><span class="comment">// Get current Java runtime version</span>
<span class="class-name">String</span> version = <span class="class-name">System</span>.getProperty(<span class="string">"java.version"</span>);
<span class="class-name">System</span>.out.println(<span class="string">"Java version: "</span> + version);

<span class="comment">// Java 9+ - More detailed version info</span>
<span class="class-name">Runtime</span>.<span class="class-name">Version</span> runtimeVersion = <span class="class-name">Runtime</span>.version();
<span class="class-name">System</span>.out.println(<span class="string">"Feature: "</span> + runtimeVersion.feature());  <span class="comment">// e.g., 17</span>
<span class="class-name">System</span>.out.println(<span class="string">"Interim: "</span> + runtimeVersion.interim());  <span class="comment">// e.g., 0</span>
<span class="class-name">System</span>.out.println(<span class="string">"Update: "</span> + runtimeVersion.update());    <span class="comment">// e.g., 1</span></code></pre>
        </section>

        <section class="content-section">
            <h2>Multi-Release JAR Files</h2>
            <p>Java 9 introduced Multi-Release JARs (MRJAR) that can contain version-specific implementations, allowing a single JAR to work optimally on multiple Java versions.</p>

            <pre><code><span class="comment">// Multi-Release JAR structure</span>
myapp.jar
├── META-INF
│   ├── MANIFEST.MF        <span class="comment"># Contains "Multi-Release: true"</span>
│   └── versions
│       ├── 9
│       │   └── com/example/Helper.class  <span class="comment"># Java 9+ version</span>
│       ├── 11
│       │   └── com/example/Helper.class  <span class="comment"># Java 11+ version</span>
│       └── 17
│           └── com/example/Helper.class  <span class="comment"># Java 17+ version</span>
└── com
    └── example
        └── Helper.class    <span class="comment"># Base version (Java 8 compatible)</span></code></pre>

            <h3>Creating Multi-Release JAR with Maven</h3>
            <pre><code><span class="comment">&lt;!-- pom.xml configuration --&gt;</span>
&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
    &lt;version&gt;3.3.0&lt;/version&gt;
    &lt;configuration&gt;
        &lt;archive&gt;
            &lt;manifestEntries&gt;
                &lt;Multi-Release&gt;true&lt;/Multi-Release&gt;
            &lt;/manifestEntries&gt;
        &lt;/archive&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
        </section>

        <section class="content-section">
            <h2>Common Compatibility Issues</h2>

            <h3>1. Removed APIs</h3>
            <pre><code><span class="comment">// Java EE modules removed in Java 11</span>
<span class="comment">// These no longer work without adding explicit dependencies:</span>

<span class="comment">// JAXB (XML Binding) - removed in Java 11</span>
<span class="keyword">import</span> javax.xml.bind.JAXBContext;  <span class="comment">// Won't compile!</span>

<span class="comment">// Solution: Add Maven dependency</span>
<span class="comment">// &lt;dependency&gt;</span>
<span class="comment">//     &lt;groupId&gt;jakarta.xml.bind&lt;/groupId&gt;</span>
<span class="comment">//     &lt;artifactId&gt;jakarta.xml.bind-api&lt;/artifactId&gt;</span>
<span class="comment">//     &lt;version&gt;4.0.0&lt;/version&gt;</span>
<span class="comment">// &lt;/dependency&gt;</span></code></pre>

            <h3>2. Deprecated for Removal</h3>
            <pre><code><span class="comment">// Check for deprecation warnings</span>
<span class="annotation">@Deprecated</span>(since = <span class="string">"9"</span>, forRemoval = <span class="keyword">true</span>)
<span class="keyword">public void</span> <span class="function">oldMethod</span>() {
    <span class="comment">// Will be removed in future version</span>
}

<span class="comment">// Compile with -Xlint:deprecation to see warnings</span>
<span class="comment">// javac -Xlint:deprecation MyClass.java</span></code></pre>

            <h3>3. Reflection Access (Java 9+)</h3>
            <pre><code><span class="comment">// Strong encapsulation in Java 9+ modules</span>
<span class="comment">// Illegal reflective access will generate warnings or errors</span>

<span class="comment">// Old code that worked in Java 8:</span>
<span class="class-name">Field</span> field = <span class="class-name">SomeClass</span>.<span class="keyword">class</span>.getDeclaredField(<span class="string">"privateField"</span>);
field.setAccessible(<span class="keyword">true</span>);  <span class="comment">// May fail in Java 9+!</span>

<span class="comment">// Solution: Add JVM arguments</span>
<span class="comment">// --add-opens java.base/java.lang=ALL-UNNAMED</span></code></pre>
        </section>

        <section class="content-section">
            <h2>Compatibility Testing Strategies</h2>

            <h3>Running Tests Against Multiple JDKs</h3>
            <pre><code><span class="comment">&lt;!-- Maven Toolchains Plugin --&gt;</span>
&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-toolchains-plugin&lt;/artifactId&gt;
    &lt;version&gt;3.1.0&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;goals&gt;
                &lt;goal&gt;toolchain&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
    &lt;configuration&gt;
        &lt;toolchains&gt;
            &lt;jdk&gt;
                &lt;version&gt;17&lt;/version&gt;
            &lt;/jdk&gt;
        &lt;/toolchains&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>

            <h3>CI/CD Matrix Testing</h3>
            <pre><code><span class="comment"># GitHub Actions example</span>
jobs:
  test:
    strategy:
      matrix:
        java: [11, 17, 21]
    steps:
      - uses: actions/setup-java@v3
        with:
          java-version: ${{ matrix.java }}
      - run: mvn test</code></pre>
        </section>

        <section class="content-section">
            <h2>Best Practices</h2>

            <div class="info-box tip">
                <div class="info-box-title">Compatibility Guidelines</div>
                <ul>
                    <li>Always specify source and target versions explicitly in build configuration</li>
                    <li>Test on all JVM versions you intend to support</li>
                    <li>Use dependency analysis tools to detect incompatible libraries</li>
                    <li>Monitor deprecation warnings and plan for removed APIs</li>
                    <li>Consider Multi-Release JARs for libraries that need to work across versions</li>
                </ul>
            </div>
        </section>

        <section class="related-topics">
            <h3>Related Topics</h3>
            <div class="related-links">
                <a href="version-history.html" class="related-link">Java Version History</a>
                <a href="source-target-compatibility.html" class="related-link">Source/Target Compatibility</a>
                <a href="backward-compatibility.html" class="related-link">Backward Compatibility</a>
            </div>
        </section>
    </main>

    <footer class="site-footer">
        <p>&copy; 2026 JavaDev Bible</p>
    </footer>

    <script src="../../js/navigation.js"></script>
</body>
</html>
